{{- $v := now.Format "20060102150405" }}
{{- $variant := .Site.Params.variant -}}
{{- $access := partial "page-allowed.html" . -}}
{{- if $access.allowed -}}
<!DOCTYPE html>
<html lang="{{- .Site.Language.Lang -}}">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    
    <!-- SEO Meta Tags -->
    <title>{{- if .Title -}}{{ .Title }} | {{ .Site.Title }}{{- else -}}{{ .Site.Title }}{{- end -}}</title>
    <meta name="description" content="{{- if .Description -}}{{ .Description | truncate 160 -}}{{- else -}}{{ .Summary | truncate 160 | default "Union.ai and Flyte documentation for AI workflow orchestration, machine learning pipelines, and data processing." -}}{{- end -}}" />
    <meta name="keywords" content="{{- if .Params.keywords -}}{{ delimit .Params.keywords ", " -}}{{- else -}}AI workflows, machine learning, data orchestration, Flyte, Union.ai, workflow automation, MLOps, data pipelines{{- end -}}" />
    <meta name="author" content="Union.ai" />
    <meta name="robots" content="{{- if .Params.noindex -}}noindex,nofollow{{- else -}}index,follow{{- end -}}" />
    
    <!-- Canonical URL -->
    <link rel="canonical" href="{{- .Permalink | absURL -}}" />
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website" />
    <meta property="og:url" content="{{- .Permalink | absURL -}}" />
    <meta property="og:title" content="{{- if .Title -}}{{ .Title }} | {{ .Site.Title }}{{- else -}}{{ .Site.Title }}{{- end -}}" />
    <meta property="og:description" content="{{- if .Description -}}{{ .Description | truncate 160 -}}{{- else -}}{{ .Summary | truncate 160 | default "Union.ai and Flyte documentation for AI workflow orchestration, machine learning pipelines, and data processing." -}}{{- end -}}" />
    <meta property="og:site_name" content="{{ .Site.Title }}" />
    <meta property="og:image" content="{{- "images/icon-logo-flyte.png" | absURL -}}" />
    <meta property="og:image:width" content="1200" />
    <meta property="og:image:height" content="630" />
    <meta property="og:image:alt" content="Union.ai Logo" />
    
    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:url" content="{{- .Permalink | absURL -}}" />
    <meta name="twitter:title" content="{{- if .Title -}}{{ .Title }} | {{ .Site.Title }}{{- else -}}{{ .Site.Title }}{{- end -}}" />
    <meta name="twitter:description" content="{{- if .Description -}}{{ .Description | truncate 160 -}}{{- else -}}{{ .Summary | truncate 160 | default "Union.ai and Flyte documentation for AI workflow orchestration, machine learning pipelines, and data processing." -}}{{- end -}}" />
    <meta name="twitter:image" content="{{- "images/icon-logo-flyte.png" | absURL -}}" />
    <meta name="twitter:image:alt" content="Union.ai Logo" />
    
    <!-- Favicon -->
    <link rel="icon" href="{{- printf "images/%s" (index .Site.Params.Key.favicon .Site.Params.variant) | relURL -}}?v={{- $v -}}"/>
    <link rel="apple-touch-icon" href="{{- "images/icon-logo-flyte.png" | relURL -}}" />
    
    <!-- Additional SEO -->
    <meta name="theme-color" content="#1a1a1a" />
    <meta name="msapplication-TileColor" content="#1a1a1a" />
    
    <!-- Enhanced SEO partial -->
    {{- partial "seo.html" . -}}
    {{- range .Site.Params.custom_css }}
    <link rel="stylesheet" href='{{- (printf "css/%s" .) | relURL -}}?v={{- $v -}}' />
    {{- end }}
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap"
      rel="stylesheet"
      media="print"
      onload="this.media='all'"
    />
    <noscript>
      <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap"
        rel="stylesheet"
      />
    </noscript>
    <link rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/@shoelace-style/shoelace@2.20.0/cdn/themes/light.css"
      media="print"
      onload="this.media='all'" />
    <link rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/@shoelace-style/shoelace@2.20.1/cdn/themes/dark.css"
      media="print"
      onload="this.media='all'" />
    <noscript>
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@shoelace-style/shoelace@2.20.0/cdn/themes/light.css" />
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@shoelace-style/shoelace@2.20.1/cdn/themes/dark.css" />
    </noscript>
    <script type="module"
      src="https://cdn.jsdelivr.net/npm/@shoelace-style/shoelace@2.20.0/cdn/shoelace-autoloader.js"
      defer></script>
    {{ if .Params.mermaid }}
    <script type="module">
      import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.esm.min.mjs';
      mermaid.initialize({
        startOnLoad: true,
        theme: 'base',
        themeVariables: {
          primaryColor: getComputedStyle(document.documentElement).getPropertyValue('--union-color').trim(),
          primaryTextColor: getComputedStyle(document.documentElement).getPropertyValue('--text-color').trim(),
          primaryBorderColor: getComputedStyle(document.documentElement).getPropertyValue('--border-color').trim(),
          lineColor: getComputedStyle(document.documentElement).getPropertyValue('--border-color').trim(),
          background: getComputedStyle(document.documentElement).getPropertyValue('--bg-color').trim(),
          edgeLabelBackground: getComputedStyle(document.documentElement).getPropertyValue('--bg-color').trim(),
          secondaryColor: getComputedStyle(document.documentElement).getPropertyValue('--union-color-very-light').trim(),
          tertiaryColor: getComputedStyle(document.documentElement).getPropertyValue('--union-color-very-light').trim(),
        }
      });
    </script>
    {{ end }}
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.32.2/tocbot.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.32.2/tocbot.min.js"></script>
    {{- range .Site.Params.custom_js }}
    <script lang="javascript" src="{{- (printf "js/%s" .) | relURL -}}?v={{- $v -}}"></script>
    {{- end }}
    <link rel="stylesheet" href="{{- "css/responsive.css" | relURL -}}?v={{- $v -}}" />
    {{ if not hugo.IsProduction }}
    <link rel="stylesheet" href="{{- "css/dev_mode.css" | relURL -}}?v={{- $v -}}" />
    {{ end }}
  </head>
  <body class="variant-{{ .Site.Params.variant }}">
    <!-- Google Tag Manager (noscript) -->
    <noscript>
      <iframe src="https://www.googletagmanager.com/ns.html?id=GTM-MB6L88S" height="0" width="0" style="display:none;visibility:hidden"></iframe>
    </noscript>
    <!-- End Google Tag Manager (noscript) -->
    {{- partial "flyte-banner.html" . -}}
    <header>{{- partial "header.html" . -}}</header>
    <div class="tabs">{{- partial "tabs.html" (dict "page" .) -}}</div>
    <div class="container">
      <div class="sidebar">{{- partial "sidebar.html" . -}}</div>
      <div class="main-content">
        {{- if $access.development -}}
        {{- $classes := slice "not-in-prod" "page-warn" }}
        {{- if $access.excluded -}}
        {{- $classes = $classes | append "not-allowed" -}}
        {{- else -}}
        {{- $classes = $classes | append "not-allowed" -}}
        {{- end -}}
        <div class='{{- delimit $classes " " -}}'>
          <div style="flex: 1">
            {{- if $access.excluded -}}
            This page was explicitly excluded from '{{- $variant -}}'.
            {{- else -}}
            This page visibility is not declared for '{{- $variant -}}'.
            <div class="not-allowed how-to-fix">
              <a href="https://github.com/unionai/unionai-docs/blob/master/AUTHOR.md#page-visibility">How to fix?</a>
            </div>
            {{- end -}}
          </div>
          <code>{{- strings.TrimSuffix "/" .RelPermalink -}}</code>
        </div>
        {{- end -}}
        {{- if (and .Site.Params.current_version (default true .Site.Params.show_deprecation_message)) -}}
        <div class="old-version">
          <div class="title">You are viewing documentation for version: {{ .Site.Params.current_version }}</div>
          <div class="message">
            Version {{ .Site.Params.current_version }} of the documentation is no longer actively maintained.
            The version you are currently viewing is a static snapshot.
            For up-to-date information, see the <a href='{{- index .Site.Params.key.docs_home .Site.Params.variant -}}'>latest version</a>.
          </div>
        </div>
        {{- end -}}
        <div class="four-notice" style="display: none;">
          <sl-alert open variant="danger">
            <sl-icon slot="icon" name="info-circle"></sl-icon>
            The page you navigated to <span class="four-page"></span> does not exist, so we brought you to the closest page to it.
          </sl-alert>
        </div>
        {{- partial "breadcrumb.html" . -}}
        {{- block "main" . -}}{{- end -}}
      </div>
      {{- partial "toc.html" . -}}
    </div>
  </body>
</html>
{{- end -}}
